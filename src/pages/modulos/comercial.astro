---
// src/pages/modulos/comercial.astro
import Layout from "../../layouts/Layout.astro";

const titulo = "Comercial";
const subtitulo = "Ventas, pedidos y facturación completa para tu joyería";
const colorPrincipal = "#06b6d4";

const blobBaseUrl = "https://raygoldstorage.blob.core.windows.net/web";

const secciones = [
  {
    id: "pedidos",
    nombre: "Pedidos",
    descripcion: "Gestión completa del ciclo de pedidos",
    imagenes: [
      { url: `${blobBaseUrl}/COM01.png`, titulo: "Listado de Pedidos", descripcion: "Vista general con estados y seguimiento" },
      { url: `${blobBaseUrl}/COM02.png`, titulo: "Nuevo Pedido", descripcion: "Creación rápida con búsqueda de artículos" },
      { url: `${blobBaseUrl}/COM03.png`, titulo: "Detalle de Pedido", descripcion: "Información completa del pedido" },
    ],
  },
  {
    id: "albaranes",
    nombre: "Albaranes",
    descripcion: "Control de entregas y expediciones",
    imagenes: [
      { url: `${blobBaseUrl}/ALB01.png`, titulo: "Albaranes", descripcion: "Gestión de albaranes de entrega" },
      { url: `${blobBaseUrl}/ALB02.png`, titulo: "Generación", descripcion: "Creación desde pedidos" },
      { url: `${blobBaseUrl}/ALB03.png`, titulo: "Impresión", descripcion: "Documentos personalizables" },
    ],
  },
  {
    id: "facturas",
    nombre: "Facturas",
    descripcion: "Facturación electrónica y tradicional",
    imagenes: [
      { url: `${blobBaseUrl}/FAC01.png`, titulo: "Facturas", descripcion: "Listado de facturas emitidas" },
      { url: `${blobBaseUrl}/FAC02.png`, titulo: "Nueva Factura", descripcion: "Facturación manual o desde albaranes" },
      { url: `${blobBaseUrl}/FAC03.png`, titulo: "Factura-E", descripcion: "Facturación electrónica integrada" },
    ],
  },
  {
    id: "clientes",
    nombre: "Clientes",
    descripcion: "Gestión integral de la cartera de clientes",
    imagenes: [
      { url: `${blobBaseUrl}/CLI01.png`, titulo: "Ficha Cliente", descripcion: "Datos completos del cliente" },
      { url: `${blobBaseUrl}/CLI02.png`, titulo: "Histórico", descripcion: "Historial de compras y operaciones" },
      { url: `${blobBaseUrl}/CLI03.png`, titulo: "Condiciones", descripcion: "Tarifas y descuentos especiales" },
    ],
  },
  {
    id: "depositos",
    nombre: "Depósitos",
    descripcion: "Control de mercancía en depósito",
    imagenes: [
      { url: `${blobBaseUrl}/DEP01.png`, titulo: "Depósitos Activos", descripcion: "Mercancía pendiente de devolución" },
      { url: `${blobBaseUrl}/DEP02.png`, titulo: "Seguimiento", descripcion: "Control de vencimientos" },
      { url: `${blobBaseUrl}/DEP03.png`, titulo: "Conversión", descripcion: "Transformación a venta" },
    ],
  },
];

const iconosSecciones: Record<string, string> = {
  pedidos: `<svg viewBox="0 0 48 48" fill="none"><rect x="8" y="6" width="32" height="36" rx="3" fill="#06b6d4" opacity="0.15"/><rect x="12" y="12" width="24" height="4" rx="1" fill="#06b6d4"/><rect x="12" y="20" width="18" height="3" rx="1" fill="#06b6d4" opacity="0.6"/><rect x="12" y="26" width="20" height="3" rx="1" fill="#06b6d4" opacity="0.6"/><rect x="12" y="32" width="14" height="3" rx="1" fill="#06b6d4" opacity="0.6"/><circle cx="36" cy="36" r="6" fill="#10b981"/><path d="M33 36l2 2 4-4" stroke="white" stroke-width="1.5" stroke-linecap="round"/></svg>`,
  albaranes: `<svg viewBox="0 0 48 48" fill="none"><rect x="6" y="8" width="28" height="32" rx="3" fill="#06b6d4" opacity="0.15"/><rect x="10" y="14" width="20" height="3" rx="1" fill="#06b6d4"/><rect x="10" y="20" width="16" height="2" rx="1" fill="#06b6d4" opacity="0.6"/><rect x="10" y="25" width="18" height="2" rx="1" fill="#06b6d4" opacity="0.6"/><rect x="14" y="10" width="28" height="32" rx="3" fill="#06b6d4" opacity="0.3"/><path d="M38 28l-8 8-4-4" stroke="#06b6d4" stroke-width="2" stroke-linecap="round"/></svg>`,
  facturas: `<svg viewBox="0 0 48 48" fill="none"><rect x="8" y="6" width="32" height="36" rx="3" fill="#06b6d4" opacity="0.15"/><rect x="12" y="12" width="24" height="4" rx="1" fill="#06b6d4"/><rect x="12" y="20" width="12" height="2" rx="1" fill="#06b6d4" opacity="0.6"/><rect x="26" y="20" width="10" height="2" rx="1" fill="#06b6d4" opacity="0.6"/><rect x="12" y="26" width="12" height="2" rx="1" fill="#06b6d4" opacity="0.6"/><rect x="26" y="26" width="10" height="2" rx="1" fill="#06b6d4" opacity="0.6"/><rect x="12" y="34" width="24" height="4" rx="1" fill="#06b6d4"/></svg>`,
  clientes: `<svg viewBox="0 0 48 48" fill="none"><circle cx="24" cy="16" r="8" fill="#06b6d4"/><path d="M10 42c0-8 6-14 14-14s14 6 14 14" fill="#06b6d4" opacity="0.3"/><circle cx="38" cy="20" r="5" fill="#06b6d4" opacity="0.5"/><circle cx="10" cy="20" r="5" fill="#06b6d4" opacity="0.5"/></svg>`,
  depositos: `<svg viewBox="0 0 48 48" fill="none"><rect x="8" y="16" width="32" height="24" rx="3" fill="#06b6d4" opacity="0.15"/><rect x="8" y="16" width="32" height="8" rx="3" fill="#06b6d4"/><circle cx="24" cy="32" r="6" fill="#06b6d4" opacity="0.4"/><path d="M24 28v8M20 32h8" stroke="#06b6d4" stroke-width="2" stroke-linecap="round"/></svg>`,
};

const iconoModulo = `<svg viewBox="0 0 64 64" fill="none">
  <rect x="8" y="16" width="48" height="36" rx="4" fill="#06b6d4" opacity="0.15"/>
  <rect x="8" y="16" width="48" height="12" rx="4" fill="#06b6d4"/>
  <circle cx="20" cy="22" r="3" fill="white"/>
  <rect x="28" y="20" width="20" height="4" rx="2" fill="white" opacity="0.6"/>
  <rect x="14" y="34" width="16" height="12" rx="2" fill="#06b6d4" opacity="0.4"/>
  <rect x="34" y="34" width="16" height="12" rx="2" fill="#06b6d4" opacity="0.4"/>
</svg>`;
---

<Layout title={`${titulo} - RayGold ERP`}>
  <main class="modulo-page">
    <header class="modulo-header">
      <div class="header-content">
        <div class="header-icon" set:html={iconoModulo} />
        <div class="header-text">
          <h1>{titulo}</h1>
          <p>{subtitulo}</p>
        </div>
      </div>
      <a href="/modulos" class="back-link">← Volver a módulos</a>
    </header>

    <nav class="secciones-nav">
      <div class="container">
        <div class="secciones-tabs">
          {secciones.map((seccion, index) => (
            <button class={`seccion-tab ${index === 0 ? "active" : ""}`} data-seccion={seccion.id}>
              <div class="tab-icon" set:html={iconosSecciones[seccion.id] || iconosSecciones.pedidos} />
              <span class="tab-label">{seccion.nombre}</span>
            </button>
          ))}
        </div>
      </div>
    </nav>

    <div class="secciones-content">
      <div class="container">
        {secciones.map((seccion, index) => (
          <section class={`seccion-panel ${index === 0 ? "active" : ""}`} data-panel={seccion.id}>
            <div class="seccion-intro">
              <h2>{seccion.nombre}</h2>
              <p class="seccion-descripcion">{seccion.descripcion}</p>
            </div>
            <div class="galeria-grid">
              {seccion.imagenes.map((img, imgIndex) => (
                <div class="galeria-item" style={`--delay: ${imgIndex * 0.1}s`}>
                  <div class="imagen-wrapper">
                    <img src={img.url} alt={img.titulo} loading="lazy" onerror="this.src='https://placehold.co/600x400/1e293b/64748b?text=Imagen+no+disponible'" />
                    <div class="imagen-overlay">
                      <button class="btn-ampliar" data-img={img.url}>
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><path d="M21 21l-4.35-4.35"/></svg>
                      </button>
                    </div>
                  </div>
                  <div class="imagen-info">
                    <h4>{img.titulo}</h4>
                    <p>{img.descripcion}</p>
                  </div>
                </div>
              ))}
            </div>
          </section>
        ))}
      </div>
    </div>

    <div class="modal-imagen" id="modalImagen">
      <button class="modal-close">&times;</button>
      <img src="" alt="Imagen ampliada" id="modalImg" />
    </div>

    <section class="cta-section">
      <div class="container">
        <p>¿Quieres ver una demostración del módulo {titulo}?</p>
        <a href="/contacto" class="cta-button">Solicitar Demo →</a>
      </div>
    </section>
  </main>
</Layout>

<style>
  .modulo-page { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; background: #0f172a; min-height: 100vh; color: white; }
  .container { max-width: 1200px; margin: 0 auto; padding: 0 1.5rem; }
  .modulo-header { background: linear-gradient(135deg, #1e293b 0%, #334155 100%); padding: 2rem 1.5rem; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 1rem; }
  .header-content { display: flex; align-items: center; gap: 1.25rem; }
  .header-icon { width: 64px; height: 64px; background: rgba(255,255,255,0.1); border-radius: 16px; padding: 8px; }
  .header-icon :global(svg) { width: 100%; height: 100%; }
  .header-text h1 { font-size: 1.75rem; font-weight: 700; margin: 0; }
  .header-text p { font-size: 0.9rem; color: #94a3b8; margin: 0.25rem 0 0; }
  .back-link { color: #94a3b8; text-decoration: none; font-size: 0.875rem; }
  .back-link:hover { color: white; }
  .secciones-nav { background: #1e293b; border-bottom: 1px solid #334155; position: sticky; top: 0; z-index: 100; }
  .secciones-tabs { display: flex; gap: 0.5rem; padding: 1rem 0; overflow-x: auto; scrollbar-width: none; }
  .secciones-tabs::-webkit-scrollbar { display: none; }
  .seccion-tab { display: flex; flex-direction: column; align-items: center; gap: 0.5rem; padding: 0.75rem 1.25rem; background: rgba(255,255,255,0.05); border: 1px solid transparent; border-radius: 12px; cursor: pointer; transition: all 0.25s; min-width: 100px; color: white; }
  .seccion-tab:hover { background: rgba(255,255,255,0.1); transform: translateY(-4px) scale(1.05); box-shadow: 0 8px 24px rgba(0,0,0,0.3); }
  .seccion-tab.active { background: rgba(6,182,212,0.2); border-color: #06b6d4; }
  .tab-icon { width: 40px; height: 40px; transition: transform 0.25s; }
  .tab-icon :global(svg) { width: 100%; height: 100%; }
  .tab-label { font-size: 0.8rem; font-weight: 500; color: #94a3b8; }
  .seccion-tab.active .tab-label { color: white; }
  .secciones-content { padding: 2rem 0; }
  .seccion-panel { display: none; animation: fadeIn 0.3s ease; }
  .seccion-panel.active { display: block; }
  @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
  .seccion-intro { margin-bottom: 2rem; text-align: center; }
  .seccion-intro h2 { font-size: 1.5rem; font-weight: 600; margin: 0 0 0.5rem; }
  .seccion-descripcion { color: #94a3b8; font-size: 1rem; margin: 0; }
  .galeria-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 1.5rem; }
  .galeria-item { background: #1e293b; border-radius: 16px; overflow: hidden; border: 1px solid #334155; transition: all 0.3s; animation: slideUp 0.5s ease forwards; animation-delay: var(--delay); opacity: 0; }
  @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
  .galeria-item:hover { border-color: #06b6d4; transform: translateY(-4px); box-shadow: 0 12px 32px rgba(0,0,0,0.3); }
  .imagen-wrapper { position: relative; aspect-ratio: 16/10; overflow: hidden; background: #0f172a; }
  .imagen-wrapper img { width: 100%; height: 100%; object-fit: cover; transition: transform 0.3s; }
  .galeria-item:hover .imagen-wrapper img { transform: scale(1.05); }
  .imagen-overlay { position: absolute; inset: 0; background: rgba(0,0,0,0.5); display: flex; align-items: center; justify-content: center; opacity: 0; transition: opacity 0.3s; }
  .galeria-item:hover .imagen-overlay { opacity: 1; }
  .btn-ampliar { width: 48px; height: 48px; background: rgba(255,255,255,0.2); border: none; border-radius: 50%; color: white; cursor: pointer; display: flex; align-items: center; justify-content: center; backdrop-filter: blur(4px); transition: all 0.2s; }
  .btn-ampliar:hover { background: #06b6d4; transform: scale(1.1); }
  .btn-ampliar svg { width: 22px; height: 22px; }
  .imagen-info { padding: 1.25rem; }
  .imagen-info h4 { font-size: 1rem; font-weight: 600; margin: 0 0 0.5rem; }
  .imagen-info p { font-size: 0.875rem; color: #94a3b8; margin: 0; line-height: 1.5; }
  .modal-imagen { position: fixed; inset: 0; background: rgba(0,0,0,0.95); display: none; align-items: center; justify-content: center; z-index: 1000; padding: 2rem; }
  .modal-imagen.active { display: flex; }
  .modal-imagen img { max-width: 100%; max-height: 90vh; border-radius: 8px; }
  .modal-close { position: absolute; top: 1rem; right: 1rem; width: 48px; height: 48px; background: rgba(255,255,255,0.1); border: none; border-radius: 50%; color: white; font-size: 1.5rem; cursor: pointer; }
  .modal-close:hover { background: #ef4444; }
  .cta-section { padding: 3rem 1.5rem; text-align: center; background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%); border-top: 1px solid #334155; }
  .cta-section p { color: #94a3b8; margin: 0 0 1rem; }
  .cta-button { display: inline-flex; padding: 0.875rem 1.75rem; background: linear-gradient(135deg, #06b6d4, #0891b2); color: white; text-decoration: none; border-radius: 10px; font-weight: 500; transition: all 0.2s; }
  .cta-button:hover { transform: translateY(-2px); box-shadow: 0 8px 24px rgba(6,182,212,0.4); }
  @media (max-width: 768px) { .modulo-header { flex-direction: column; align-items: flex-start; } .header-icon { width: 48px; height: 48px; } .header-text h1 { font-size: 1.5rem; } .galeria-grid { grid-template-columns: 1fr; } }
</style>

<script>
  document.querySelectorAll(".seccion-tab").forEach(tab => {
    tab.addEventListener("click", () => {
      const seccionId = (tab as HTMLElement).dataset.seccion;
      document.querySelectorAll(".seccion-tab").forEach(t => t.classList.remove("active"));
      tab.classList.add("active");
      document.querySelectorAll(".seccion-panel").forEach(p => p.classList.remove("active"));
      document.querySelector(`[data-panel="${seccionId}"]`)?.classList.add("active");
    });
  });
  const modal = document.getElementById("modalImagen");
  const modalImg = document.getElementById("modalImg") as HTMLImageElement;
  document.querySelectorAll(".btn-ampliar").forEach(btn => {
    btn.addEventListener("click", () => {
      const imgSrc = (btn as HTMLElement).dataset.img;
      if (modalImg && imgSrc) { modalImg.src = imgSrc; modal?.classList.add("active"); }
    });
  });
  document.querySelector(".modal-close")?.addEventListener("click", () => modal?.classList.remove("active"));
  modal?.addEventListener("click", e => { if (e.target === modal) modal.classList.remove("active"); });
  document.addEventListener("keydown", e => { if (e.key === "Escape") modal?.classList.remove("active"); });
</script>
