---
/**
 * Modulos.astro - Sección de módulos del ERP
 * Con soporte multiidioma y tema adaptativo móvil
 */
import { type Lang, getModuloUrl } from "@/config/pages";

interface Props {
  lang?: Lang;
}

const { lang = 'es' } = Astro.props;

// Traducciones
const translations: Record<Lang, {
  badge: string;
  title: string;
  subtitle: string;
  modulos: Array<{
    key: string;
    title: string;
    description: string;
  }>;
}> = {
  es: {
    badge: "Solución completa",
    title: "8 módulos integrados para tu joyería",
    subtitle: "Todo lo que necesitas en un solo sistema",
    modulos: [
      { key: "maestros", title: "Maestros", description: "Artículos, proveedores, clientes y familias" },
      { key: "comercial", title: "Comercial", description: "Ventas, pedidos y facturación" },
      { key: "fabricacion", title: "Fabricación", description: "Producción, inventarios y calidad" },
      { key: "finanzas", title: "Finanzas", description: "Contabilidad, tesorería e IVA" },
      { key: "historicos", title: "Históricos", description: "Datos históricos y tendencias" },
      { key: "estadisticas", title: "Estadísticas", description: "Informes y cuadros de mando" },
      { key: "vendedores", title: "Vendedores", description: "Gestión de rutas y visitas" },
      { key: "ecommerce", title: "Ecommerce", description: "Tiendas online y marketplaces" },
    ],
  },
  en: {
    badge: "Complete solution",
    title: "8 integrated modules for your jewelry",
    subtitle: "Everything you need in one system",
    modulos: [
      { key: "maestros", title: "Masters", description: "Items, suppliers, customers and families" },
      { key: "comercial", title: "Commercial", description: "Sales, orders and invoicing" },
      { key: "fabricacion", title: "Manufacturing", description: "Production, inventory and quality" },
      { key: "finanzas", title: "Finance", description: "Accounting, treasury and VAT" },
      { key: "historicos", title: "History", description: "Historical data and trends" },
      { key: "estadisticas", title: "Statistics", description: "Reports and dashboards" },
      { key: "vendedores", title: "Sales Reps", description: "Route and visit management" },
      { key: "ecommerce", title: "Ecommerce", description: "Online stores and marketplaces" },
    ],
  },
  fr: {
    badge: "Solution complète",
    title: "8 modules intégrés pour votre bijouterie",
    subtitle: "Tout ce dont vous avez besoin dans un seul système",
    modulos: [
      { key: "maestros", title: "Maîtres", description: "Articles, fournisseurs, clients et familles" },
      { key: "comercial", title: "Commercial", description: "Ventes, commandes et facturation" },
      { key: "fabricacion", title: "Fabrication", description: "Production, inventaires et qualité" },
      { key: "finanzas", title: "Finances", description: "Comptabilité, trésorerie et TVA" },
      { key: "historicos", title: "Historique", description: "Données historiques et tendances" },
      { key: "estadisticas", title: "Statistiques", description: "Rapports et tableaux de bord" },
      { key: "vendedores", title: "Vendeurs", description: "Gestion des routes et visites" },
      { key: "ecommerce", title: "Ecommerce", description: "Boutiques en ligne et marketplaces" },
    ],
  },
  ca: {
    badge: "Solució completa",
    title: "8 mòduls integrats per a la teva joieria",
    subtitle: "Tot el que necessites en un sol sistema",
    modulos: [
      { key: "maestros", title: "Mestres", description: "Articles, proveïdors, clients i famílies" },
      { key: "comercial", title: "Comercial", description: "Vendes, comandes i facturació" },
      { key: "fabricacion", title: "Fabricació", description: "Producció, inventaris i qualitat" },
      { key: "finanzas", title: "Finances", description: "Comptabilitat, tresoreria i IVA" },
      { key: "historicos", title: "Històrics", description: "Dades històriques i tendències" },
      { key: "estadisticas", title: "Estadístiques", description: "Informes i quadres de comandament" },
      { key: "vendedores", title: "Venedors", description: "Gestió de rutes i visites" },
      { key: "ecommerce", title: "Ecommerce", description: "Botigues online i marketplaces" },
    ],
  },
  'pt-br': {
    badge: "Solução completa",
    title: "8 módulos integrados para sua joalheria",
    subtitle: "Tudo o que você precisa em um único sistema",
    modulos: [
      { key: "maestros", title: "Mestres", description: "Artigos, fornecedores, clientes e famílias" },
      { key: "comercial", title: "Comercial", description: "Vendas, pedidos e faturamento" },
      { key: "fabricacion", title: "Fabricação", description: "Produção, inventários e qualidade" },
      { key: "finanzas", title: "Finanças", description: "Contabilidade, tesouraria e IVA" },
      { key: "historicos", title: "Históricos", description: "Dados históricos e tendências" },
      { key: "estadisticas", title: "Estatísticas", description: "Relatórios e painéis" },
      { key: "vendedores", title: "Vendedores", description: "Gestão de rotas e visitas" },
      { key: "ecommerce", title: "Ecommerce", description: "Lojas online e marketplaces" },
    ],
  },
};

const t = translations[lang] || translations.es;

// Iconos SVG para cada módulo
const iconos: Record<string, string> = {
  maestros: `<svg viewBox="0 0 48 48" fill="none"><rect x="6" y="8" width="36" height="32" rx="3" fill="currentColor" opacity="0.15"/><rect x="10" y="12" width="28" height="6" rx="2" fill="currentColor"/><rect x="10" y="22" width="20" height="3" rx="1" fill="currentColor" opacity="0.6"/><rect x="10" y="28" width="24" height="3" rx="1" fill="currentColor" opacity="0.6"/><circle cx="34" cy="34" r="5" fill="#10b981"/><path d="M32 34l2 2 3-3" stroke="white" stroke-width="1.5" stroke-linecap="round"/></svg>`,
  comercial: `<svg viewBox="0 0 48 48" fill="none"><rect x="6" y="12" width="36" height="28" rx="3" fill="currentColor" opacity="0.15"/><rect x="6" y="12" width="36" height="10" rx="3" fill="currentColor"/><circle cx="16" cy="17" r="3" fill="white"/><rect x="22" y="15" width="16" height="4" rx="2" fill="white" opacity="0.6"/><rect x="10" y="26" width="12" height="10" rx="2" fill="currentColor" opacity="0.4"/><rect x="26" y="26" width="12" height="10" rx="2" fill="currentColor" opacity="0.4"/></svg>`,
  fabricacion: `<svg viewBox="0 0 48 48" fill="none"><rect x="4" y="26" width="12" height="16" rx="2" fill="currentColor"/><rect x="18" y="18" width="12" height="24" rx="2" fill="currentColor" opacity="0.7"/><rect x="32" y="10" width="12" height="32" rx="2" fill="currentColor" opacity="0.4"/><circle cx="10" cy="14" r="6" fill="currentColor" opacity="0.3"/><circle cx="10" cy="14" r="3" fill="currentColor"/></svg>`,
  finanzas: `<svg viewBox="0 0 48 48" fill="none"><rect x="6" y="8" width="36" height="32" rx="3" fill="currentColor" opacity="0.15"/><rect x="10" y="12" width="28" height="8" rx="2" fill="currentColor"/><path d="M16 28h16M16 34h12" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/><circle cx="36" cy="32" r="6" fill="currentColor" opacity="0.3"/><text x="36" y="35" text-anchor="middle" fill="currentColor" font-size="10" font-weight="bold">€</text></svg>`,
  historicos: `<svg viewBox="0 0 48 48" fill="none"><rect x="6" y="8" width="36" height="32" rx="3" fill="currentColor" opacity="0.15"/><rect x="10" y="12" width="28" height="6" rx="2" fill="currentColor"/><circle cx="24" cy="30" r="10" fill="currentColor" opacity="0.3"/><path d="M24 24v6l5 3" stroke="currentColor" stroke-width="2" stroke-linecap="round"/><circle cx="24" cy="30" r="2" fill="currentColor"/></svg>`,
  estadisticas: `<svg viewBox="0 0 48 48" fill="none"><rect x="6" y="8" width="36" height="32" rx="3" fill="currentColor" opacity="0.15"/><rect x="10" y="28" width="6" height="10" rx="1" fill="currentColor"/><rect x="19" y="22" width="6" height="16" rx="1" fill="currentColor" opacity="0.7"/><rect x="28" y="16" width="6" height="22" rx="1" fill="currentColor" opacity="0.5"/><path d="M10 20l9-4 9 3 9-6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>`,
  vendedores: `<svg viewBox="0 0 48 48" fill="none"><circle cx="24" cy="16" r="8" fill="currentColor"/><path d="M12 42c0-8 5-12 12-12s12 4 12 12" fill="currentColor" opacity="0.4"/><circle cx="38" cy="22" r="5" fill="currentColor" opacity="0.6"/><circle cx="10" cy="22" r="5" fill="currentColor" opacity="0.6"/></svg>`,
  ecommerce: `<svg viewBox="0 0 48 48" fill="none"><circle cx="24" cy="24" r="18" fill="currentColor" opacity="0.15"/><ellipse cx="24" cy="24" rx="18" ry="8" stroke="currentColor" stroke-width="2"/><ellipse cx="24" cy="24" rx="8" ry="18" stroke="currentColor" stroke-width="2"/><line x1="6" y1="24" x2="42" y2="24" stroke="currentColor" stroke-width="2"/><line x1="24" y1="6" x2="24" y2="42" stroke="currentColor" stroke-width="2"/><circle cx="24" cy="24" r="3" fill="currentColor"/></svg>`,
};

// Colores por módulo
const colores: Record<string, string> = {
  maestros: "#667eea",
  comercial: "#06b6d4",
  fabricacion: "#f59e0b",
  finanzas: "#10b981",
  historicos: "#8b5cf6",
  estadisticas: "#ec4899",
  vendedores: "#3b82f6",
  ecommerce: "#6366f1",
};
---

<section class="modulos-section">
  <div class="modulos-container">
    <div class="modulos-header">
      <span class="section-badge">{t.badge}</span>
      <h2>{t.title}</h2>
      <p>{t.subtitle}</p>
    </div>

    <div class="modulos-grid">
      {t.modulos.map((modulo) => (
        <a
          href={getModuloUrl(modulo.key, lang)}
          class="modulo-card"
          style={`--card-color: ${colores[modulo.key]}`}
        >
          <div class="modulo-icon" style={`color: ${colores[modulo.key]}`} set:html={iconos[modulo.key]} />
          <h4>{modulo.title}</h4>
          <p>{modulo.description}</p>
        </a>
      ))}
    </div>
  </div>
</section>

<style>
  /* ============================================
     DESKTOP: Tema azul oscuro (default)
     ============================================ */
  .modulos-section {
    padding: 5rem 1.5rem;
    background: linear-gradient(180deg, #0f172a 0%, #1e293b 100%);
  }

  .modulos-container {
    max-width: 1200px;
    margin: 0 auto;
  }

  .modulos-header {
    text-align: center;
    margin-bottom: 3rem;
  }

  .section-badge {
    display: inline-block;
    padding: 0.5rem 1rem;
    background: rgba(102, 126, 234, 0.2);
    color: #818cf8;
    font-size: 0.75rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.1em;
    border-radius: 50px;
    margin-bottom: 1rem;
  }

  .modulos-header h2 {
    font-size: 2rem;
    font-weight: 700;
    color: white;
    margin: 0 0 0.5rem;
  }

  .modulos-header p {
    color: #94a3b8;
    font-size: 1.1rem;
    margin: 0;
  }

  .modulos-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 1.25rem;
  }

  .modulo-card {
    background: rgba(30, 41, 59, 0.6);
    border: 1px solid #334155;
    border-radius: 16px;
    padding: 1.5rem;
    text-align: center;
    text-decoration: none;
    transition: all 0.3s ease;
    position: relative;
    overflow: hidden;
  }

  .modulo-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 3px;
    background: var(--card-color);
    transform: scaleX(0);
    transition: transform 0.3s ease;
  }

  .modulo-card:hover::before {
    transform: scaleX(1);
  }

  .modulo-card:hover {
    background: rgba(51, 65, 85, 0.8);
    transform: translateY(-4px);
    box-shadow: 0 12px 32px rgba(0, 0, 0, 0.3);
    border-color: var(--card-color);
  }

  .modulo-icon {
    width: 64px;
    height: 64px;
    margin: 0 auto 16px;
    transition: transform 0.3s ease;
  }

  .modulo-card:hover .modulo-icon {
    transform: scale(1.1);
  }

  .modulo-icon svg {
    width: 100%;
    height: 100%;
  }

  .modulo-card h4 {
    font-size: 1.1rem;
    font-weight: 600;
    color: white;
    margin: 0 0 8px;
  }

  .modulo-card p {
    font-size: 0.85rem;
    color: #94a3b8;
    line-height: 1.5;
    margin: 0;
  }

  @media (max-width: 1024px) {
    .modulos-grid {
      grid-template-columns: repeat(2, 1fr);
    }
  }

  /* ============================================
     MÓVIL: Tema blanco claro
     ============================================ */
  @media (max-width: 768px) {
    .modulos-section {
      padding: 3rem 1rem;
      background: linear-gradient(180deg, #ffffff 0%, #f8fafc 100%);
    }

    .section-badge {
      background: rgba(102, 126, 234, 0.1);
      color: #667eea;
    }

    .modulos-header h2 {
      font-size: 1.5rem;
      color: #1e293b;
    }

    .modulos-header p {
      color: #64748b;
    }

    .modulos-grid {
      grid-template-columns: repeat(2, 1fr);
      gap: 12px;
    }

    .modulo-card {
      background: #f8fafc;
      border: 1px solid #e2e8f0;
      padding: 1.25rem 1rem;
    }

    .modulo-card:hover {
      background: #f1f5f9;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.08);
    }

    .modulo-icon {
      width: 48px;
      height: 48px;
    }

    .modulo-card h4 {
      font-size: 0.95rem;
      color: #1e293b;
    }

    .modulo-card p {
      font-size: 0.75rem;
      color: #64748b;
    }
  }
</style>
