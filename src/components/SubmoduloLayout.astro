---
/**
 * Layout Base para Submódulos
 * Reutilizable por todos los módulos: Maestros, Comercial, etc.
 * Con tema adaptativo: azul oscuro desktop, blanco móvil
 * 
 * @file src/components/SubmoduloLayout.astro
 */
import Layout from "@/layouts/Layout.astro";
import { getAlternateUrls, getPageUrl, type Lang } from "@/config/pages";
import { 
  getSubmoduloTranslations, 
  modulosConfig, 
  type ModuloId,
  type ModuloTranslation,
  type CommonTranslation,
  type SectionTranslation,
  type ImageTranslation
} from "@/i18n/submodulos";

interface Props {
  lang: string;
  moduloId: ModuloId;
}

const { lang, moduloId } = Astro.props;
const alternateUrls = getAlternateUrls(`modulos/${moduloId}` as any);

// Obtener traducciones con tipos explícitos
const translations = getSubmoduloTranslations(lang, moduloId);
const common: CommonTranslation = translations.common;
const modulo: ModuloTranslation = translations.modulo;
const config = modulosConfig[moduloId];

// URL base de imágenes
const blobBaseUrl = "https://raygoldstorage.blob.core.windows.net/web";

// Interfaz para secciones construidas
interface SeccionConstruida {
  id: string;
  nombre: string;
  descripcion: string;
  imagenes: {
    url: string;
    titulo: string;
    descripcion: string;
  }[];
}

// Construir secciones con datos traducidos e imágenes
const secciones: SeccionConstruida[] = config.secciones
  .map((secConfig): SeccionConstruida | null => {
    const seccionData = modulo.sections[secConfig.id] as SectionTranslation | undefined;
    if (!seccionData) return null;
    
    return {
      id: secConfig.id,
      nombre: seccionData.name,
      descripcion: seccionData.description,
      imagenes: seccionData.images.map((img: ImageTranslation, index: number) => ({
        url: `${blobBaseUrl}/${secConfig.prefix}0${index + 1}.png`,
        titulo: img.title,
        descripcion: img.description,
      })),
    };
  })
  .filter((s): s is SeccionConstruida => s !== null);

// Iconos SVG para secciones (genéricos por tipo)
const iconosSecciones: Record<string, string> = {
  // Maestros
  articulos: `<svg viewBox="0 0 48 48" fill="none"><rect x="6" y="8" width="36" height="32" rx="3" fill="currentColor" opacity="0.15"/><rect x="10" y="12" width="28" height="6" rx="2" fill="currentColor"/><rect x="10" y="22" width="20" height="3" rx="1" fill="currentColor" opacity="0.6"/><rect x="10" y="28" width="24" height="3" rx="1" fill="currentColor" opacity="0.6"/><circle cx="34" cy="34" r="5" fill="#10b981"/><path d="M32 34l2 2 3-3" stroke="white" stroke-width="1.5" stroke-linecap="round"/></svg>`,
  precios: `<svg viewBox="0 0 48 48" fill="none"><rect x="8" y="10" width="32" height="28" rx="3" fill="currentColor" opacity="0.15"/><path d="M24 16v16M20 20h8c1.5 0 3 1 3 3s-1.5 3-3 3h-6c-1.5 0-3 1-3 3s1.5 3 3 3h8" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/></svg>`,
  estructuras: `<svg viewBox="0 0 48 48" fill="none"><rect x="8" y="6" width="14" height="10" rx="2" fill="currentColor"/><rect x="26" y="6" width="14" height="10" rx="2" fill="currentColor" opacity="0.6"/><rect x="17" y="34" width="14" height="10" rx="2" fill="currentColor" opacity="0.8"/><path d="M15 16v4M33 16v4M15 30v4h9M33 30v-4h-9" stroke="currentColor" stroke-width="2"/></svg>`,
  imagenes: `<svg viewBox="0 0 48 48" fill="none"><rect x="6" y="10" width="36" height="28" rx="3" fill="currentColor" opacity="0.15"/><circle cx="18" cy="22" r="4" fill="currentColor"/><path d="M10 30l8-6 6 4 8-8 6 6v4a2 2 0 01-2 2H12a2 2 0 01-2-2v-0z" fill="currentColor"/></svg>`,
  layout: `<svg viewBox="0 0 48 48" fill="none"><rect x="6" y="8" width="36" height="32" rx="3" fill="currentColor" opacity="0.15"/><rect x="10" y="12" width="12" height="24" rx="2" fill="currentColor" opacity="0.4"/><rect x="26" y="12" width="12" height="10" rx="2" fill="currentColor"/></svg>`,
   gestion: `<svg viewBox="0 0 48 48" fill="none"><path d="M18 24l-8 8 4 4 8-8" fill="currentColor" opacity="0.6"/><path d="M30 24l8 8-4 4-8-8" fill="currentColor" opacity="0.6"/><rect x="14" y="8" width="8" height="20" rx="2" transform="rotate(-45 14 8)" fill="currentColor"/><rect x="26" y="8" width="8" height="20" rx="2" transform="rotate(45 34 8)" fill="currentColor"/><circle cx="24" cy="24" r="4" fill="currentColor"/></svg>`,
   // Comercial
  pedidos: `<svg viewBox="0 0 48 48" fill="none"><rect x="8" y="6" width="32" height="36" rx="3" fill="currentColor" opacity="0.15"/><rect x="12" y="10" width="24" height="4" rx="1" fill="currentColor"/><rect x="12" y="18" width="18" height="3" rx="1" fill="currentColor" opacity="0.6"/><rect x="12" y="24" width="20" height="3" rx="1" fill="currentColor" opacity="0.6"/><rect x="12" y="30" width="16" height="3" rx="1" fill="currentColor" opacity="0.6"/></svg>`,
  albaranes: `<svg viewBox="0 0 48 48" fill="none"><rect x="8" y="6" width="32" height="36" rx="3" fill="currentColor" opacity="0.15"/><path d="M16 16h16M16 22h12M16 28h14" stroke="currentColor" stroke-width="2" stroke-linecap="round"/><circle cx="34" cy="34" r="6" fill="currentColor"/><path d="M32 34l2 2 3-3" stroke="white" stroke-width="1.5"/></svg>`,
  facturas: `<svg viewBox="0 0 48 48" fill="none"><rect x="8" y="6" width="32" height="36" rx="3" fill="currentColor" opacity="0.15"/><rect x="12" y="10" width="24" height="6" rx="1" fill="currentColor"/><path d="M12 22h10M12 28h14M12 34h8" stroke="currentColor" stroke-width="2" stroke-linecap="round" opacity="0.6"/></svg>`,
  libro: `<svg viewBox="0 0 48 48" fill="none"><rect x="8" y="6" width="32" height="36" rx="3" fill="currentColor" opacity="0.15"/><rect x="8" y="6" width="6" height="36" rx="1" fill="currentColor" opacity="0.4"/><rect x="16" y="12" width="18" height="3" rx="1" fill="currentColor" opacity="0.6"/><rect x="16" y="18" width="14" height="2" rx="1" fill="currentColor" opacity="0.4"/><rect x="16" y="23" width="16" height="2" rx="1" fill="currentColor" opacity="0.4"/><path d="M20 30h12l2 10H18l2-10z" fill="#f59e0b"/><rect x="22" y="32" width="8" height="2" rx="0.5" fill="#fbbf24" opacity="0.6"/></svg>`,
   depositos: `<svg viewBox="0 0 48 48" fill="none"><path d="M24 4L4 16h40L24 4z" fill="currentColor"/><rect x="4" y="16" width="40" height="4" fill="currentColor" opacity="0.8"/><rect x="4" y="38" width="40" height="6" rx="1" fill="currentColor"/><rect x="8" y="20" width="6" height="18" fill="currentColor" opacity="0.6"/><rect x="21" y="20" width="6" height="18" fill="currentColor" opacity="0.6"/><rect x="34" y="20" width="6" height="18" fill="currentColor" opacity="0.6"/></svg>`,
  // Fabricación
  ordenes: `<svg viewBox="0 0 48 48" fill="none"><rect x="8" y="8" width="32" height="32" rx="3" fill="currentColor" opacity="0.15"/><rect x="12" y="12" width="24" height="6" rx="1" fill="currentColor"/><path d="M12 24h20M12 30h16M12 36h18" stroke="currentColor" stroke-width="2" stroke-linecap="round" opacity="0.6"/></svg>`,
  fases: `<svg viewBox="0 0 48 48" fill="none"><circle cx="12" cy="24" r="6" fill="currentColor"/><circle cx="24" cy="24" r="6" fill="currentColor" opacity="0.7"/><circle cx="36" cy="24" r="6" fill="currentColor" opacity="0.4"/><path d="M18 24h2M30 24h2" stroke="currentColor" stroke-width="2"/></svg>`,
  fundicion: `<svg viewBox="0 0 48 48" fill="none"><path d="M14 12h20l4 8v16a4 4 0 01-4 4H14a4 4 0 01-4-4V20l4-8z" fill="currentColor" opacity="0.2"/><path d="M18 20h12M18 28h8" stroke="currentColor" stroke-width="2" stroke-linecap="round"/><circle cx="34" cy="32" r="4" fill="currentColor"/></svg>`,
  inventario: `<svg viewBox="0 0 48 48" fill="none"><rect x="8" y="14" width="32" height="26" rx="3" fill="currentColor" opacity="0.15"/><rect x="12" y="8" width="24" height="8" rx="2" fill="currentColor"/><path d="M16 22h16M16 28h12M16 34h14" stroke="currentColor" stroke-width="2" stroke-linecap="round" opacity="0.6"/></svg>`,
  // Finanzas
  contabilidad: `<svg viewBox="0 0 48 48" fill="none"><rect x="8" y="8" width="32" height="32" rx="3" fill="currentColor" opacity="0.15"/><rect x="12" y="12" width="24" height="6" rx="1" fill="currentColor"/><path d="M12 24h10M26 24h10M12 30h8M26 30h10M12 36h12M26 36h6" stroke="currentColor" stroke-width="2" stroke-linecap="round" opacity="0.6"/></svg>`,
  tesoreria: `<svg viewBox="0 0 48 48" fill="none"><rect x="6" y="16" width="36" height="24" rx="3" fill="currentColor" opacity="0.15"/><rect x="6" y="16" width="36" height="8" rx="3" fill="currentColor"/><circle cx="24" cy="32" r="4" fill="currentColor" opacity="0.6"/></svg>`,
  iva: `<svg viewBox="0 0 48 48" fill="none"><rect x="8" y="8" width="32" height="32" rx="3" fill="currentColor" opacity="0.15"/><text x="24" y="30" text-anchor="middle" fill="currentColor" font-size="14" font-weight="bold">%</text></svg>`,
  bancos: `<svg viewBox="0 0 48 48" fill="none"><path d="M8 18l16-10 16 10v4H8v-4z" fill="currentColor"/><rect x="12" y="24" width="6" height="14" fill="currentColor" opacity="0.6"/><rect x="21" y="24" width="6" height="14" fill="currentColor" opacity="0.6"/><rect x="30" y="24" width="6" height="14" fill="currentColor" opacity="0.6"/><rect x="8" y="38" width="32" height="4" rx="1" fill="currentColor"/></svg>`,
  informes: `<svg viewBox="0 0 48 48" fill="none"><rect x="8" y="8" width="32" height="32" rx="3" fill="currentColor" opacity="0.15"/><rect x="12" y="28" width="6" height="10" rx="1" fill="currentColor"/><rect x="21" y="22" width="6" height="16" rx="1" fill="currentColor" opacity="0.7"/><rect x="30" y="16" width="6" height="22" rx="1" fill="currentColor" opacity="0.5"/></svg>`,
  // Históricos
  operaciones: `<svg viewBox="0 0 48 48" fill="none"><rect x="8" y="8" width="32" height="32" rx="3" fill="currentColor" opacity="0.15"/><path d="M14 14h20M14 22h16M14 30h18M14 38h12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>`,
  trazabilidad: `<svg viewBox="0 0 48 48" fill="none"><circle cx="16" cy="16" r="4" fill="currentColor"/><circle cx="32" cy="16" r="4" fill="currentColor" opacity="0.7"/><circle cx="24" cy="32" r="4" fill="currentColor" opacity="0.5"/><path d="M18 18l4 10M30 18l-4 10" stroke="currentColor" stroke-width="2"/></svg>`,
  // Estadísticas
  dashboards: `<svg viewBox="0 0 48 48" fill="none"><rect x="6" y="6" width="16" height="16" rx="2" fill="currentColor"/><rect x="26" y="6" width="16" height="16" rx="2" fill="currentColor" opacity="0.6"/><rect x="6" y="26" width="16" height="16" rx="2" fill="currentColor" opacity="0.6"/><rect x="26" y="26" width="16" height="16" rx="2" fill="currentColor" opacity="0.4"/></svg>`,
  // Vendedores
  aplicacion: `<svg viewBox="0 0 48 48" fill="none"><circle cx="24" cy="14" r="6" fill="currentColor"/><circle cx="12" cy="20" r="4" fill="currentColor" opacity="0.6"/><circle cx="36" cy="20" r="4" fill="currentColor" opacity="0.6"/><path d="M16 38c0-6 4-10 8-10s8 4 8 10" fill="currentColor" opacity="0.4"/></svg>`,
  gestionv: `<svg viewBox="0 0 48 48" fill="none"><circle cx="16" cy="16" r="4" fill="currentColor"/><circle cx="32" cy="24" r="4" fill="currentColor" opacity="0.7"/><circle cx="20" cy="36" r="4" fill="currentColor" opacity="0.5"/><path d="M18 18l12 4M30 26l-8 8" stroke="currentColor" stroke-width="2" stroke-dasharray="4 2"/></svg>`,
 // E-commerce
  catalogo: `<svg viewBox="0 0 48 48" fill="none"><rect x="6" y="6" width="16" height="16" rx="2" fill="currentColor"/><rect x="26" y="6" width="16" height="16" rx="2" fill="currentColor" opacity="0.7"/><rect x="6" y="26" width="16" height="16" rx="2" fill="currentColor" opacity="0.5"/><rect x="26" y="26" width="16" height="16" rx="2" fill="currentColor" opacity="0.3"/></svg>`,
  integraciones: `<svg viewBox="0 0 48 48" fill="none"><circle cx="24" cy="24" r="6" fill="currentColor"/><circle cx="12" cy="12" r="4" fill="currentColor" opacity="0.6"/><circle cx="36" cy="12" r="4" fill="currentColor" opacity="0.6"/><circle cx="12" cy="36" r="4" fill="currentColor" opacity="0.6"/><circle cx="36" cy="36" r="4" fill="currentColor" opacity="0.6"/><path d="M14 14l8 8M34 14l-8 8M14 34l8-8M34 34l-8-8" stroke="currentColor" stroke-width="2"/></svg>`,
  // Impresoras 3D
  modelos: `<svg viewBox="0 0 48 48" fill="none"><rect x="8" y="8" width="32" height="32" rx="3" fill="currentColor" opacity="0.15"/><rect x="12" y="12" width="24" height="6" rx="1" fill="currentColor"/><path d="M24 22v16" stroke="currentColor" stroke-width="3" stroke-linecap="round"/><path d="M18 30h12" stroke="currentColor" stroke-width="3" stroke-linecap="round"/></svg>`,
  impresion: `<svg viewBox="0 0 48 48" fill="none"><rect x="8" y="8" width="32" height="32" rx="3" fill="currentColor" opacity="0.15"/><rect x="12" y="12" width="24" height="8" rx="2" fill="currentColor"/><rect x="16" y="24" width="16" height="12" rx="2" fill="currentColor" opacity="0.4"/></svg>`,
  materiales: `<svg viewBox="0 0 48 48" fill="none"><circle cx="24" cy="24" r="14" fill="currentColor" opacity="0.15"/><circle cx="24" cy="24" r="8" fill="currentColor" opacity="0.4"/><circle cx="24" cy="24" r="4" fill="currentColor"/></svg>`,
};

// Obtener icono por defecto si no existe
const getSeccionIcon = (id: string): string => iconosSecciones[id] || iconosSecciones.articulos;
---

<Layout
  title={modulo.metaTitle}
  description={modulo.metaDescription}
  lang={lang as Lang}
  alternateUrls={alternateUrls}
>
  <main class="modulo-page" style={`--modulo-color: ${config.color}`}>
    <!-- Header del módulo -->
    <header class="modulo-header">
      <div class="header-content">
        <div class="header-icon" set:html={config.icon} />
        <div class="header-text">
          <h1>{modulo.title}</h1>
          <p>{modulo.subtitle}</p>
        </div>
      </div>
      <a href={getPageUrl("modulos" as any, lang as Lang)} class="back-link">
        {common.backToModules}
      </a>
    </header>

    <!-- Navegación de secciones -->
    <nav class="secciones-nav">
      <div class="container">
        <div class="secciones-tabs">
          {secciones.map((seccion, index: number) => (
            <button
              class={`seccion-tab ${index === 0 ? "active" : ""}`}
              data-seccion={seccion.id}
            >
              <div class="tab-icon" set:html={getSeccionIcon(seccion.id)} />
              <span class="tab-label">{seccion.nombre}</span>
            </button>
          ))}
        </div>
      </div>
    </nav>

    <!-- Contenido de secciones -->
    <div class="secciones-content">
      <div class="container">
        {secciones.map((seccion, index: number) => (
          <section
            class={`seccion-panel ${index === 0 ? "active" : ""}`}
            data-panel={seccion.id}
          >
            <div class="seccion-intro">
              <h2>{seccion.nombre}</h2>
              <p class="seccion-descripcion">{seccion.descripcion}</p>
            </div>

            <div class="galeria-grid">
              {seccion.imagenes.map((imagen, imgIndex: number) => (
                <article class="galeria-item" style={`--delay: ${imgIndex * 0.1}s`}>
                  <div class="imagen-wrapper">
                    <img src={imagen.url} alt={imagen.titulo} loading="lazy" />
                    <div class="imagen-overlay">
                      <button class="btn-ampliar" data-img={imagen.url}>
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                          <path d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM10 7v6M7 10h6" />
                        </svg>
                      </button>
                    </div>
                  </div>
                  <div class="imagen-info">
                    <h4>{imagen.titulo}</h4>
                    <p>{imagen.descripcion}</p>
                  </div>
                </article>
              ))}
            </div>
          </section>
        ))}
      </div>
    </div>

    <!-- Modal de imagen -->
    <div id="modalImagen" class="modal-imagen">
      <button class="modal-close">×</button>
      <img id="modalImg" src="" alt="Imagen ampliada" />
    </div>

    <!-- CTA -->
    <section class="cta-section">
      <div class="container">
        <p>{common.seeInAction}</p>
        <a href={getPageUrl("contacto" as any, lang as Lang)} class="cta-button">
          {common.requestDemo}
        </a>
      </div>
    </section>
  </main>
</Layout>

<style>
  /* ============================================
     DESKTOP: Tema azul oscuro (default)
     ============================================ */
  .modulo-page {
    background: #0f172a;
    min-height: 100vh;
    color: white;
  }

  .container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 1.5rem;
  }

  /* Header del módulo */
  .modulo-header {
    background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
    padding: 2rem 1.5rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-bottom: 1px solid #334155;
  }

  .header-content {
    display: flex;
    align-items: center;
    gap: 1.25rem;
  }

  .header-icon {
    width: 64px;
    height: 64px;
    color: var(--modulo-color);
  }

  .header-icon :global(svg) {
    width: 100%;
    height: 100%;
  }

  .header-text h1 {
    font-size: 1.75rem;
    font-weight: 700;
    margin: 0 0 0.25rem;
    background: linear-gradient(135deg, #fff, #94a3b8);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }

  .header-text p {
    color: #94a3b8;
    margin: 0;
    font-size: 1rem;
  }

  .back-link {
    color: #94a3b8;
    text-decoration: none;
    font-size: 0.9rem;
    transition: color 0.2s;
  }

  .back-link:hover {
    color: var(--modulo-color);
  }

  /* Navegación de secciones */
  .secciones-nav {
    background: rgba(30, 41, 59, 0.8);
    border-bottom: 1px solid #334155;
    position: sticky;
    top: 72px;
    z-index: 50;
    backdrop-filter: blur(8px);
  }

  .secciones-tabs {
    display: flex;
    gap: 0.5rem;
    padding: 1rem 0;
    overflow-x: auto;
    scrollbar-width: none;
  }

  .secciones-tabs::-webkit-scrollbar {
    display: none;
  }

  .seccion-tab {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.5rem;
    padding: 0.75rem 1.25rem;
    background: transparent;
    border: 1px solid transparent;
    border-radius: 12px;
    color: #94a3b8;
    cursor: pointer;
    transition: all 0.2s ease;
    min-width: 100px;
  }

  .seccion-tab:hover {
    background: rgba(102, 126, 234, 0.1);
    color: white;
  }

  .seccion-tab.active {
    background: rgba(102, 126, 234, 0.2);
    border-color: var(--modulo-color);
    color: white;
  }

  .tab-icon {
    width: 40px;
    height: 40px;
    color: var(--modulo-color);
  }

  .tab-icon :global(svg) {
    width: 100%;
    height: 100%;
  }

  .tab-label {
    font-size: 0.8rem;
    font-weight: 500;
    white-space: nowrap;
  }

  /* Contenido de secciones */
  .secciones-content {
    padding: 2rem 0;
  }

  .seccion-panel {
    display: none;
    animation: fadeIn 0.3s ease;
  }

  .seccion-panel.active {
    display: block;
  }

  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
  }

  .seccion-intro {
    margin-bottom: 2rem;
    text-align: center;
  }

  .seccion-intro h2 {
    font-size: 1.5rem;
    font-weight: 600;
    margin: 0 0 0.5rem;
  }

  .seccion-descripcion {
    color: #94a3b8;
    font-size: 1rem;
    margin: 0;
  }

  /* Galería */
  .galeria-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
    gap: 1.5rem;
  }

  .galeria-item {
    background: #1e293b;
    border-radius: 16px;
    overflow: hidden;
    border: 1px solid #334155;
    transition: all 0.3s ease;
    animation: slideUp 0.5s ease forwards;
    animation-delay: var(--delay);
    opacity: 0;
  }

  @keyframes slideUp {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
  }

  .galeria-item:hover {
    border-color: var(--modulo-color);
    transform: translateY(-4px);
    box-shadow: 0 12px 32px rgba(0, 0, 0, 0.3);
  }

  .imagen-wrapper {
    position: relative;
    aspect-ratio: 16/10;
    overflow: hidden;
    background: #0f172a;
  }

  .imagen-wrapper img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.3s ease;
  }

  .galeria-item:hover .imagen-wrapper img {
    transform: scale(1.05);
  }

  .imagen-overlay {
    position: absolute;
    inset: 0;
    background: rgba(0, 0, 0, 0.5);
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 0;
    transition: opacity 0.3s ease;
  }

  .galeria-item:hover .imagen-overlay {
    opacity: 1;
  }

  .btn-ampliar {
    width: 48px;
    height: 48px;
    background: rgba(255, 255, 255, 0.2);
    border: none;
    border-radius: 50%;
    color: white;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    backdrop-filter: blur(4px);
    transition: all 0.2s ease;
  }

  .btn-ampliar:hover {
    background: var(--modulo-color);
    transform: scale(1.1);
  }

  .btn-ampliar svg {
    width: 22px;
    height: 22px;
  }

  .imagen-info {
    padding: 1.25rem;
  }

  .imagen-info h4 {
    font-size: 1rem;
    font-weight: 600;
    margin: 0 0 0.5rem;
  }

  .imagen-info p {
    font-size: 0.875rem;
    color: #94a3b8;
    margin: 0;
    line-height: 1.5;
  }

  /* Modal */
  .modal-imagen {
    position: fixed;
    inset: 0;
    background: rgba(0, 0, 0, 0.95);
    display: none;
    align-items: center;
    justify-content: center;
    z-index: 1000;
    padding: 2rem;
  }

  .modal-imagen.active {
    display: flex;
  }

  .modal-imagen img {
    max-width: 100%;
    max-height: 90vh;
    border-radius: 8px;
  }

  .modal-close {
    position: absolute;
    top: 1rem;
    right: 1rem;
    width: 48px;
    height: 48px;
    background: rgba(255, 255, 255, 0.1);
    border: none;
    border-radius: 50%;
    color: white;
    font-size: 1.5rem;
    cursor: pointer;
    transition: background 0.2s ease;
  }

  .modal-close:hover {
    background: #ef4444;
  }

  /* CTA */
  .cta-section {
    padding: 3rem 1.5rem;
    text-align: center;
    background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
    border-top: 1px solid #334155;
  }

  .cta-section p {
    color: #94a3b8;
    margin: 0 0 1rem;
  }

  .cta-button {
    display: inline-flex;
    padding: 0.875rem 1.75rem;
    background: linear-gradient(135deg, var(--modulo-color), #764ba2);
    color: white;
    text-decoration: none;
    border-radius: 10px;
    font-weight: 500;
    transition: all 0.2s ease;
  }

  .cta-button:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 24px rgba(102, 126, 234, 0.4);
  }

  /* ============================================
     MÓVIL: Tema blanco claro
     ============================================ */
  @media (max-width: 768px) {
    .modulo-page {
      background: #ffffff;
      color: #1e293b;
    }

    /* Header */
    .modulo-header {
      background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
      border-bottom: 1px solid #e2e8f0;
      flex-direction: column;
      align-items: flex-start;
      gap: 1rem;
    }

    .header-icon {
      width: 48px;
      height: 48px;
    }

    .header-text h1 {
      font-size: 1.5rem;
      background: linear-gradient(135deg, #1e293b, #475569);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .header-text p {
      color: #64748b;
    }

    .back-link {
      color: #64748b;
    }

    .back-link:hover {
      color: var(--modulo-color);
    }

    /* Navegación de secciones */
    .secciones-nav {
      background: rgba(255, 255, 255, 0.95);
      border-bottom: 1px solid #e2e8f0;
      top: 72px;
    }

    .seccion-tab {
      padding: 0.5rem 1rem;
      min-width: 80px;
      color: #64748b;
    }

    .seccion-tab:hover {
      background: rgba(102, 126, 234, 0.08);
      color: #1e293b;
    }

    .seccion-tab.active {
      background: rgba(102, 126, 234, 0.1);
      border-color: var(--modulo-color);
      color: #1e293b;
    }

    .tab-icon {
      width: 32px;
      height: 32px;
    }

    .tab-label {
      font-size: 0.7rem;
    }

    /* Contenido */
    .seccion-intro h2 {
      color: #1e293b;
    }

    .seccion-descripcion {
      color: #64748b;
    }

    /* Galería */
    .galeria-grid {
      grid-template-columns: 1fr;
    }

    .galeria-item {
      background: #f8fafc;
      border: 1px solid #e2e8f0;
    }

    .galeria-item:hover {
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.08);
    }

    .imagen-wrapper {
      background: #e2e8f0;
    }

    .imagen-info h4 {
      color: #1e293b;
    }

    .imagen-info p {
      color: #64748b;
    }

    /* CTA */
    .cta-section {
      background: linear-gradient(135deg, rgba(102, 126, 234, 0.05) 0%, rgba(118, 75, 162, 0.05) 100%);
      border-top: 1px solid #e2e8f0;
    }

    .cta-section p {
      color: #64748b;
    }
  }
</style>

<script>
  // Tabs
  document.querySelectorAll(".seccion-tab").forEach((tab) => {
    tab.addEventListener("click", () => {
      const seccionId = (tab as HTMLElement).dataset.seccion;
      document.querySelectorAll(".seccion-tab").forEach((t) => t.classList.remove("active"));
      tab.classList.add("active");
      document.querySelectorAll(".seccion-panel").forEach((p) => p.classList.remove("active"));
      document.querySelector(`[data-panel="${seccionId}"]`)?.classList.add("active");
    });
  });

  // Modal
  const modal = document.getElementById("modalImagen");
  const modalImg = document.getElementById("modalImg") as HTMLImageElement;

  document.querySelectorAll(".btn-ampliar").forEach((btn) => {
    btn.addEventListener("click", () => {
      const imgSrc = (btn as HTMLElement).dataset.img;
      if (modalImg && imgSrc) {
        modalImg.src = imgSrc;
        modal?.classList.add("active");
      }
    });
  });

  document.querySelector(".modal-close")?.addEventListener("click", () => {
    modal?.classList.remove("active");
  });

  modal?.addEventListener("click", (e) => {
    if (e.target === modal) modal.classList.remove("active");
  });

  document.addEventListener("keydown", (e) => {
    if (e.key === "Escape") modal?.classList.remove("active");
  });
</script>
